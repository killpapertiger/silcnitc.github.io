<!Doctype html>
<html lang="en">
    <head>
        <title>Input Files</title>
        <meta charset="UTF-8">
        <!--<link rel="stylesheet" href="css/bootstrap.min.css">-->
        <link rel="stylesheet" href="css/style_new.css">
        <script src="js/jquery-1.12.1.min.js" charset="utf-8"></script>
        <link rel="stylesheet" href="js/embed-2cd369fa1c0830bd3aa06c21d4f14a13e060d2d31bbaae740f4af4.css"><div id="gist28627206" class="gist">
        <link rel="stylesheet" href="js/embed-cbe5b40fa72b0964f90d4919c2da8f8f94d7c9f6c2aa49c07f6fa3.css"><div id="gist28627206" class="gist">
        <script src="js/bootstrap.min.js" charset="utf-8"></script>
        <!-- CSS only -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <!-- JavaScript Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    </head>
    <div class="container">
        <header id="navtop">
            <a href="index.html" class="logo fleft"><img src="img/logo.png" alt=""></a>
            <nav class="fright">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About</a></li>
        			 <!--   <li><a href="help.html">Help</a></li> -->
        			    <li><a href="roadmap.html">Roadmap</a></li>
        			    <li><a href="documentation.html" class="navactive">Documentation</a></li>
                </ul>
            </nav>
        </header>
        <body>
        <div class="Services-page main grid-wrap">
            <header class="grid col-full">
                <hr/>
                <p class="fleft">Input Files</p>
                <br>
                <br>
            </header>
            <aside class="grid col-one-quarter mq2-col-full sticky_sidebar" style="position: static;">
              <menu>
                <ul>
                  <li><a class="sec" href="#nav-lex">lex.l file</a></li>
                  <li><a class="sec" href="#nav-parser">parser.y file</a></li>
                  <li><a class="sec" href="#nav-function">infixtoprefix function</a></li>
                  <li><a class="sec" href="#nav-input">input file</a></li>
                </ul>
              </menu>
               <!-- <a class="button" href="">Download as PDF</a> -->
            </aside>
            <section class="grid col-three-quarters mq2-col-full">
                <div class="grid-wrap">
                    <article class="grid col-full" id="nav-lex">
                        <h2>lex.l file</h2>
                        <div class="well" style="background-color: rgb(243, 239, 234); border-radius: 5px; padding: 10px;">
                            <pre>
%{
	#include <stdio.h>
	#include "y.tab.h"
	#include "exprtree.h"
	#include <stdlib.h>
	int number;
	char*temp;

%}

%%

begin	{return begin;}
end 	{return END;}
break	{return BREAK;}
continue	{return CONTINUE;}
read 	{return READ;}
write 	{return WRITE;}
then 	{return then;}
else 	{return ELSE;}
endif	{return endif;}
if	{return IF;}
do	{return DO;}
endwhile {return endwhile;}
while	{return WHILE;}
[0-9]+	{return NUM;}
[a-z]+ {yylval.p=createTree(-1,tINT,yytext,tVAR,NULL,NULL,NULL); return ID;}
"+"	{return PLUS;}
"-"	{return MINUS;}
"*"	{return MUL;}
"/"	{return DIV;}
"<="	{return LE;}
">="	{return GE;}
"<"	{return LT;}
">"	{return GT;}
"!="	{return NE;}
"=="	{return EQ;}
"="	{return ASSIGN;}
";" {return EOL;}
[ \t]	{}
[' '] {}
[()]	{return *yytext;}
[\n]	{}
.	{}


%%

int yywrap(void) {
	return 1;
}
                            </pre>
                        </div>
                    </article>
                    <article class="grid col-full" id="nav-parser">
                        <h2>parser.y file</h2>
                        <div class="well" style="background-color: rgb(243, 239, 234); border-radius: 5px; padding: 10px;">
                            <pre>
%{
	#include <stdlib.h>
	#include <stdio.h>
	//#define YYSTYPE tnode*
	#include "tree.h"
	#include "tree.c"
	extern struct tnode* idptr;
	FILE* targetFile;
	int yylex(void);
	extern FILE *yyin;
	extern char* yytext;
	
%}
%union{
	struct tnode* p;
}
%token NUM PLUS MINUS MUL DIV ID begin END READ WRITE EOL IF then ELSE endif WHILE DO endwhile GT LT LE GE NE EQ ASSIGN BREAK CONTINUE
%type<p> expr Slist Stmt Breakstmt Continuestmt InputStmt OutputStmt AsgStmt Ifstmt Whilestmt ID
%left PLUS MINUS
%left MUL DIV
%nonassoc GT LT LE GE EQ NE
%%
Program : begin Slist END EOL	{fprintf(targetFile,"%d\n%d\n%d\n%d\n%d\n%d\n%d\n%d\nMOV SP, 4121\n",0,2056,0,0,0,0,1,0);
				//codeGen(targetFile,$2);
				infixtoprefix(targetFile,$2);
				printExit(targetFile);
				return 0;				
				}
	| begin END EOL	{printf("Empty program\n;");return 0;}
	;

Slist : Slist Stmt		{$$=createTree(-1,-1,NULL,tCONNECT,$1,$2,NULL);}
	| Stmt			{$$=$1;} 	
	;

Stmt : InputStmt 		{$$=$1;}
	| OutputStmt 		{$$=$1;}
	| AsgStmt 		{$$=$1;}
	| Ifstmt		{$$=$1;}
	| Whilestmt		{$$=$1;}
	| Breakstmt		{$$=$1;}
	| Continuestmt		{$$=$1;}
	;

Breakstmt : BREAK EOL			{$$=createTree(-1,-1,NULL,tBREAK,NULL,NULL,NULL);}
	;

Continuestmt : CONTINUE EOL		{$$=createTree(-1,-1,NULL,tCONTINUE,NULL,NULL,NULL);}
	;
InputStmt : READ '(' ID ')' EOL	{$$=createTree(-1,-1,NULL,tREAD,$3,NULL,NULL);}  
	;

OutputStmt : WRITE '(' expr ')' EOL	{$$=createTree(-1,-1,NULL,tWRITE,$3,NULL,NULL);} 
	;

AsgStmt : ID ASSIGN expr EOL {$$ = createTree(-1,-1,NULL,tASSIGN,$1,$3,NULL);} 
	;
Ifstmt : IF '(' expr ')' then Slist ELSE Slist endif EOL	{$$=createTree(-1,-1,NULL,tIF,$3,$6,$8);}
	| IF '(' expr ')' then Slist endif EOL		{$$=createTree(-1,-1,NULL,tIF,$3,$6,NULL);}
	;
Whilestmt : WHILE '(' expr ')' DO Slist endwhile EOL		{$$=createTree(-1,-1,NULL,tWHILE,$3,$6,NULL);}
	;
expr : expr PLUS expr		{$$ = createTree(-1,-1,"+",tADD,$1,$3,NULL);}
	 | expr MINUS expr  	{$$ = createTree(-1,-1,"-",tSUB,$1,$3,NULL);}
	 | expr MUL expr	{$$ = createTree(-1,-1,"*",tMUL,$1,$3,NULL);}
	 | expr DIV expr	{$$ = createTree(-1,-1,"/",tDIV,$1,$3,NULL);}
	 | '(' expr ')'	{$$ = $2;}
	 | expr LT expr 		{$$ = createTree(-1,-1,NULL,tLT,$1,$3,NULL);}
	 | expr GT expr 		{$$ = createTree(-1,-1,NULL,tGT,$1,$3,NULL);}
	 | expr LE expr 		{$$ = createTree(-1,-1,NULL,tLE,$1,$3,NULL);}
	 | expr GE expr 		{$$ = createTree(-1,-1,NULL,tGE,$1,$3,NULL);}
	 | expr NE expr 		{$$ = createTree(-1,-1,NULL,tNE,$1,$3,NULL);}
	 | expr EQ expr		{$$ = createTree(-1,-1,NULL,tEQ,$1,$3,NULL);}
	 | NUM			{$$ = createTree(atoi(yytext),tINT,NULL,tNUM,NULL,NULL,NULL);}
	 | ID			{$$=$1;}
	 ;

%%

yyerror(char const *s)
{
    printf("yyerror %s and %s",s,yytext);
}


int main(int argc, char*argv[]) {
	targetFile=fopen("targetFile.xsm","w");
	if(targetFile==NULL){
		printf("file error\n");
	}
	yyin=fopen(argv[1],"r");
	yyparse();
	fclose(targetFile);
	return 0;
}

                            </pre>
                        </div>
                    </article>
                    <article class="grid col-full" id="nav-function">
                        <h2>infixtoprefix function</h2>
                        <div class="well" style="background-color: rgb(243, 239, 234); border-radius: 5px; padding: 10px;">
                            <pre>
void infixtoprefix(FILE* fp, struct tnode* root){
	if(root!=NULL){
		printf("%s ",root->symbol);
		fprintf(fp,"%s ",root->symbol);
		infixtoprefix(fp,root->left);
		infixtoprefix(fp,root->right);
	}
}
                            </pre>
                        </div>
                    </article>

                    <article class="grid col-full" id="nav-input">
                        <h2>input file</h2>
                        <div class="well" style="background-color: rgb(243, 239, 234); border-radius: 5px; padding: 10px; padding-bottom: 3px;">
                            <pre>
    abc+(bcd-efg)*hij
                            </pre>
                        </div>
                    </article>

                </div>
            </section>
        </div>
    </div>
    </body>
    <footer class="center part clearfix">
        <ul class="grid col-one-third social">
            <li><a href="http://github.com/silcnitc">Github</a></li>
            <li>  <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
                <img alt="Creative Commons License" style="border-width:0" src="img/creativecommons.png" /></a></li>
        </ul>
        <div class="grid col-one-third" style="color:black;">
            <p style="font-weight: bold;">Contributed By : <a href="https://www.linkedin.com/in/in/siddharth-ravi-6a1876198/">S R Siddharth</a>
            </p>
        </div>
        <nav class="grid col-one-third ">
            <ul >
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <!-- <li><a href="uc.html">Contact</a></li> -->
            </ul>
        </nav>
        <br>
    </footer>
    <script>window.jQuery || document.write('<script src="js/jquery-1.7.2.min.js"><\/script>')</script>
    <script src="js/scripts.js"></script>
    <script src="js/inject.js"></script>
</html>